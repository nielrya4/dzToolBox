<div id="new_project_modal" class="modal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="frame" id="content">
                <div class="modal-header">
                    <h5 class="modal-title">New Project</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="container-sm">
                    <form id="new_project_form" enctype="multipart/form-data" hx-post="/new_project" hx-target="#project_list" hx-swap="outerHTML">
                        <br />
                        <div class="row" style="margin: 0;">
                            <label for="project_name">Project Name</label>
                            <input class="form-control" type="text" id="project_name" name="project_name" required hx-validate="true">
                        </div>
                        <br />
                        <div class="row">
                            <label for="data_file">Import Data (Optional)</label>
                            <input class="form-control" type="file" id="data_file" name="data_file" accept=".xlsx, .xls, .csv" hx-validate="true">
                        </div>
                        <br />
                        <div class="row">
                            <div>
                                <button class="btn btn-primary" id="create_new_project" type="post">Create New Project</button>
                            </div>
                        </div>
                        <br />
                    </form>
                    <button id="modal_hide_button" type="button" style="display: none" data-bs-toggle="modal" data-bs-target="#new_project_modal"></button>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const create_proj_btn = document.getElementById("create_new_project")
    const modal_hide_btn = document.getElementById("modal_hide_button")
    const new_proj_form = document.getElementById("new_project_form")
    
    // Close modal immediately after form validation and submission
    new_proj_form.addEventListener('submit', function(event) {
        const projectName = document.getElementById('project_name').value.trim();
        
        // Basic validation
        if (!projectName) {
            alert('Please enter a project name.');
            event.preventDefault();
            return false;
        }
        
        // Close modal immediately after validation
        const modal = bootstrap.Modal.getInstance(document.getElementById('new_project_modal'));
        if (modal) {
            modal.hide();
        }
        
        // Reset form for next use
        setTimeout(() => {
            new_proj_form.reset();
        }, 500);
    });

</script>
